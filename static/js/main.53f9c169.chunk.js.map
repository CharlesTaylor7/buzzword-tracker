{"version":3,"sources":["components/Graph.js","dataSources/useRecords.js","dataSources/corsRequest.js","dataSources/philPapers.js","serviceWorker.js","index.js","App.js"],"names":["Graph","_ref","query","yearRange","record$","_yearRange","Object","slicedToArray","start","end","_useRecords","_useState","useState","records","stemsToRecords","yearsToRecords","_useState2","state","setState","useEffect","subscribe","record","blackList","splitOn","words","R","propName","split","stemmer","stem","updatedRecords","objectSpread","defineProperty","id","stems","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","word","value","concat","toConsumableArray","err","return","years","year","useRecords","recordCount","keys","length","console","log","recordIds","data","_ref2","_ref3","_ref4","_ref5","percentage","dataPoint","amt","react_default","a","createElement","es6","width","height","dataKey","type","stroke","label","Graph_Label","Label","_ref6","x","y","dy","fill","fontSize","textAnchor","corsAnywhere","corsRequest","asyncToGenerator","regenerator_default","mark","_callee","url","response","wrap","_context","prev","fetch","sent","abrupt","t0","stop","_x","apply","this","arguments","xml","parser","escapeCharacter","char","getTokenSuffix","token","map","join","escape","getLastPartOfPath","path","match","_wrapRegExp","key","groups","recordSet$","Observable","pipe","Rx","text","_xml$parse$OAIPMH$Li","parse","ListRecords","resumptionToken","metadata","_i","_Object$entries","entries","prop","title","String","identifier","date","author","creator","language","json","array","Boolean","window","location","hostname","ReactDOM","render","setQuery","className","onChange","event","target","style","margin","Graph_Graph","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.53f9c169.chunk.js","sourcesContent":["import React from 'react';\r\nimport { useRecords } from '../dataSources/useRecords';\r\nimport {\r\n  LineChart,\r\n  XAxis,\r\n  YAxis,\r\n  Line,\r\n  Tooltip,\r\n} from 'recharts';\r\nimport * as R from 'ramda';\r\nimport stem from 'lancaster-stemmer';\r\n\r\nexport const Graph = ({query, yearRange, record$}) => {\r\n  const [ start, end ] = yearRange;\r\n  const {\r\n    records,\r\n    stemsToRecords,\r\n    yearsToRecords,\r\n  } = useRecords(record$);\r\n\r\n  const recordCount = Object.keys(records).length;\r\n  console.log(recordCount);\r\n  const recordIds = stemsToRecords[stem(query)];\r\n  const data = recordIds\r\n    ? R.pipe(\r\n        R.map(id => records[id]),\r\n        R.groupBy(R.prop('year')),\r\n        R.toPairs,\r\n        R.filter(([year, _]) => year >= start && year <= end),\r\n        R.map(([year, group]) => ({\r\n          year,\r\n          percentage: 100 * group.length / yearsToRecords[year].length,\r\n        })),\r\n        R.map(dataPoint => {\r\n          return { ...dataPoint, amt: dataPoint.percentage };\r\n        })\r\n      )(recordIds)\r\n    : [];\r\n  const getTotal = year => yearsToRecords[year]\r\n    ? yearsToRecords[year].length\r\n    : 0;\r\n\r\n  return (\r\n    <LineChart width={1200} height={500} data={data}>\r\n      <Tooltip />\r\n      <XAxis dataKey=\"year\"/>\r\n      <YAxis />\r\n      <Line type=\"linear\" dataKey=\"percentage\" stroke =\"#8484d8\" label={<Label />}/>\r\n    </LineChart>\r\n  );\r\n}\r\n\r\nconst Label = ({\r\n  x,\r\n  y,\r\n  stroke,\r\n  value,\r\n}) => (\r\n  <text\r\n    x={x}\r\n    y={y}\r\n    dy={-4}\r\n    fill={stroke}\r\n    fontSize={10}\r\n    textAnchor=\"middle\"\r\n  >\r\n    {value}\r\n  </text>\r\n);\r\n","import { useState, useEffect } from 'react';\r\nimport * as R from 'ramda';\r\nimport stemmer from 'lancaster-stemmer';\r\n\r\nexport const useRecords = (record$) => {\r\n  // state: { lookup: { [stem: string]: RecordId[] }, recordCount: number }\r\n  // where RecordId = string\r\n  // a map from word stems to a list of records containing that stem.\r\n  // The frequency of a stem is size of its dictionary entry divided by the record count.\r\n  const [ state, setState ] = useState({\r\n    records: {},\r\n    stemsToRecords: {},\r\n    yearsToRecords: {},\r\n  });\r\n\r\n  useEffect(() => {\r\n    record$.subscribe(record => {\r\n      const blackList = /^([0-9]+|s|the|of|on|and|to|in|at|for)$/;\r\n      const splitOn = /[\\s,.\\-_'â€™]/;\r\n      const propNames = ['title', 'description'];\r\n\r\n      const words = R.pipe(\r\n        R.chain(propName =>\r\n          record[propName]\r\n          ? record[propName].split(splitOn)\r\n          : []),\r\n        R.map(stemmer),\r\n        R.filter(stem =>\r\n          !R.isEmpty(stem) &&\r\n          R.isEmpty(R.match(blackList, stem))),\r\n        R.uniq,\r\n      )(propNames);\r\n\r\n      setState(state => {\r\n        const { stemsToRecords, yearsToRecords, records } = state;\r\n\r\n        const updatedRecords = {...records, [record.id]: record};\r\n\r\n        const stems = { ...stemsToRecords };\r\n        for (const word of words) {\r\n          if (stems[word] === undefined) {\r\n            stems[word] = [record.id];\r\n          } else {\r\n            stems[word] = [...stems[word], record.id];\r\n          }\r\n        }\r\n\r\n        const years = { ...yearsToRecords };\r\n        const { year } = record;\r\n        if (years[year] === undefined) {\r\n          years[year] = [record.id];\r\n        } else {\r\n          years[year] = [...years[year], record.id];\r\n        }\r\n\r\n        return {\r\n          records: updatedRecords,\r\n          stemsToRecords: stems,\r\n          yearsToRecords: years,\r\n        };\r\n      });\r\n    });\r\n  }, []);\r\n\r\n  return state;\r\n};\r\n","import { fromFetch } from 'rxjs/fetch';\n\nlet corsAnywhere = 'https://cors-holy-water.herokuapp.com/';\n// let corsAnywhere = '';\n\nexport const corsRequest = async url => {\n  try {\n    const response = await fetch(`${corsAnywhere}${url}`);\n    return response;\n  } catch {\n    corsAnywhere = '';\n    console.log('Cors proxy failed.');\n  }\n  return fetch(`${corsAnywhere}${url}`);\n}","import parser from 'fast-xml-parser';\r\nimport * as Rx from 'rxjs/operators';\r\nimport * as Observable from 'rxjs';\r\nimport { corsRequest } from './corsRequest';\r\nconst xml = parser;\r\n\r\nconst escapeCharacter = char => {\r\n  switch (char) {\r\n    case '/': return '%2F';\r\n    case '?': return '%3F';\r\n    case '#': return '%23';\r\n    case '=': return '%3D';\r\n    case ':': return '%3A';\r\n    case ';': return '%3B';\r\n    case ' ': return '%20';\r\n    case '%': return '%25';\r\n    case '+': return '%2B';\r\n    default: return char;\r\n  }\r\n};\r\nconst escape = token => token.split().map(escapeCharacter).join();\r\n\r\nconst getTokenSuffix = token =>\r\n  token\r\n  ? `&resumptionToken=${escape(token)}`\r\n  : '';\r\nconst recordSet$ = (token) =>\r\n  Observable.from(\r\n    corsRequest(\r\n      `https://philpapers.org/oai.pl?verb=ListRecords&metadataPrefix=oai_dc${getTokenSuffix(token)}`))\r\n  .pipe(\r\n    Rx.flatMap(response => response.text()),\r\n    Rx.flatMap(text => {\r\n      const {\r\n        record: records,\r\n        resumptionToken,\r\n      } = xml.parse(text)['OAI-PMH'].ListRecords;\r\n\r\n      return Observable.concat(\r\n        Observable.from(records),\r\n        recordSet$(resumptionToken)\r\n      );\r\n    })\r\n  );\r\n\r\nconst getLastPartOfPath = path => path.match(/^.*\\/(?<key>.*)$/).groups.key;\r\nconst getPropName = dcPropName => dcPropName.match(/^dc:(?<prop>\\w+)$/).groups.prop;\r\n\r\nconst getRecordMetadata = record => {\r\n  const metadata = {};\r\n  for (const [key, value] of Object.entries(record.metadata['oai_dc:dc'])) {\r\n    const prop = getPropName(key);\r\n    metadata[prop] = value;\r\n  }\r\n\r\n  metadata.title = metadata.title ? String(metadata.title) : null;\r\n  metadata.id = getLastPartOfPath(metadata.identifier);\r\n  delete metadata.identifier;\r\n\r\n  metadata.year = metadata.date;\r\n  delete metadata.date;\r\n\r\n  metadata.type = getLastPartOfPath(metadata.type);\r\n\r\n  metadata.author = metadata.creator;\r\n  delete metadata.creator;\r\n\r\n  return metadata;\r\n}\r\n\r\nexport const record$ = recordSet$()\r\n  .pipe(\r\n    Rx.map(getRecordMetadata),\r\n    Rx.filter(record =>\r\n      record.language === 'en' &&\r\n      record.title &&\r\n      typeof record.year === 'number'\r\n    ),\r\n  );\r\n\r\n// ToDo: Figure out how to parse and decompress data from archive.\r\nconst getDoc = id => Observable.from(corsRequest(`https://philPapers.org/archive/${id}`));\r\n\r\nconst apiId = '904518';\r\nconst apiKey = '5KLo4qkvXNl4t8s5';\r\n\r\nexport const category$ =\r\n  Observable.from(\r\n    corsRequest(\r\n      `https://philPapers.org/philpapers/raw/categories.json?apiId=${apiId}&apiKey=${apiKey}`))\r\n  .pipe(\r\n    Rx.flatMap(response => response.json()),\r\n    Rx.map(array => array[0])\r\n  );\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport { App } from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","import React, { useState } from 'react';\r\nimport './App.css';\r\nimport { Graph } from './components/Graph';\r\n// import { record$ } from './dataSources/philosophyPaperboy';\r\nimport { record$ } from './dataSources/philPapers';\r\n\r\nexport const App = () => {\r\n  const [ query, setQuery ] = useState('');\r\n\r\n  const onChange = event => setQuery(event.target.value);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        {/* <p>Trending: \"{query}\"</p> */}\r\n        <label>\r\n            Trend for:\r\n            <input\r\n              type=\"text\"\r\n              value={query}\r\n              onChange={onChange}\r\n              style={{margin:'10px'}}\r\n            />\r\n          </label>\r\n        <Graph\r\n          query={query}\r\n          record$={record$}\r\n          yearRange={[2000, 2018]}\r\n        />\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n"],"sourceRoot":""}